---
layout: jupyter
title: Numpy (1)
published: true
date: 2022-11-14
description: Numpy의 기초
comments: true
categories:
 - python
tags:
 - python
 - numpy
toc: true
toc_sticky: true
toc_label: Numpy의 기초
---
---
# Numpy 가져오기

NumPy(Numerical Python)는 거의 모든 과학 및 공학 분야에서 사용되는 오픈 소스 Python 라이브러리이다. Python에서 숫자 데이터로 작업할 때의 보편적인 표준이고 과학적 Python 및 PyData 생태계의 핵심이다. NumPy 사용자는 초급 코더에서부터 최첨단 과학, 연구 및 개발 산업 분야의 경험이 풍부한 연구원까지 모든 사람을 포함한다. NumPy API는 Pandas, SciPy, Matplotlib, scikit-learn, scikit-image 그리고 기타 대부분의 데이터 사이언스, 과학적 Python 패키지에서 널리 사용되고 있다.

<div class="in_prompt">
In&nbsp;[1]:
</div>

<div class="input_area" markdown="1">

```python
import numpy as np
```

</div>

<div class="in_prompt">
In&nbsp;[2]:
</div>

<div class="input_area" markdown="1">

```python
np.__version__
```

</div>

<div class="output_prompt">
Out&nbsp;[2]:
</div>




{:.output_data_text}

```
'1.21.5'
```



## Numpy 예제

<div class="in_prompt">
In&nbsp;[3]:
</div>

<div class="input_area" markdown="1">

```python
# range array 생성
a = np.arange(6)
a
```

</div>

<div class="output_prompt">
Out&nbsp;[3]:
</div>




{:.output_data_text}

```
array([0, 1, 2, 3, 4, 5])
```



<div class="in_prompt">
In&nbsp;[4]:
</div>

<div class="input_area" markdown="1">

```python
a2 = a[np.newaxis, :]
a2
```

</div>

<div class="output_prompt">
Out&nbsp;[4]:
</div>




{:.output_data_text}

```
array([[0, 1, 2, 3, 4, 5]])
```



<div class="in_prompt">
In&nbsp;[5]:
</div>

<div class="input_area" markdown="1">

```python
a2.shape
```

</div>

<div class="output_prompt">
Out&nbsp;[5]:
</div>




{:.output_data_text}

```
(1, 6)
```



# Numpy array와 Python list의 차이

Numpy array의 모든 요소는 데이터 타입이 같아야 한다. array에 대해 수행되는 수학 연산은 array의 요소의 데이터 타입이 다를 경우 극도로 비효율적이다.

Python list보다 빠르고 컴팩트하다. Array는 메모리가 적고 사용하기 편리하다. Numpy는 데이터를 저장하는 데 훨씬 적은 메모리를 사용한다. 데이터 유형을 지정하는 메커니즘을 제공한다. 이를 통해 코드를 더욱 최적화 할 수 있다.

# Array란? 

Array란 Numpy 라이브러리의 중심 데이터 구조이다.

<div class="in_prompt">
In&nbsp;[6]:
</div>

<div class="input_area" markdown="1">

```python
# array 생성
a = np.array([1, 2, 3, 4, 5, 6])
```

</div>

<div class="in_prompt">
In&nbsp;[7]:
</div>

<div class="input_area" markdown="1">

```python
# 통일된 array element의 데이터 타입 보기
a.dtype
```

</div>

<div class="output_prompt">
Out&nbsp;[7]:
</div>




{:.output_data_text}

```
dtype('int32')
```



<div class="in_prompt">
In&nbsp;[8]:
</div>

<div class="input_area" markdown="1">

```python
# 다른 타입을 넣을 경우 하나로 통일시킴
a = np.array([1., 2, 3, 4, 5, 6])
a.dtype
```

</div>

<div class="output_prompt">
Out&nbsp;[8]:
</div>




{:.output_data_text}

```
dtype('float64')
```



<div class="in_prompt">
In&nbsp;[9]:
</div>

<div class="input_area" markdown="1">

```python
a = np.array(['1', 2, 3, 4, 5, 6])
a.dtype
```

</div>

<div class="output_prompt">
Out&nbsp;[9]:
</div>




{:.output_data_text}

```
dtype('<U11')
```



<div class="in_prompt">
In&nbsp;[10]:
</div>

<div class="input_area" markdown="1">

```python
# 속성(attribute)호출 : ()없음
# 메서드 호출 : ()있음
a.ndim # number of array dimensions
```

</div>

<div class="output_prompt">
Out&nbsp;[10]:
</div>




{:.output_data_text}

```
1
```



<div class="in_prompt">
In&nbsp;[11]:
</div>

<div class="input_area" markdown="1">

```python
# shape : integer형태의 tuple로 각 dimension의 크기를 나타냄
a.shape
```

</div>

<div class="output_prompt">
Out&nbsp;[11]:
</div>




{:.output_data_text}

```
(6,)
```



<div class="in_prompt">
In&nbsp;[12]:
</div>

<div class="input_area" markdown="1">

```python
a = np.array([[1, 2, 3, 4], [5, 6, 7, 8], [9, 10, 11, 12]])
a.dtype
```

</div>

<div class="output_prompt">
Out&nbsp;[12]:
</div>




{:.output_data_text}

```
dtype('int32')
```



<div class="in_prompt">
In&nbsp;[13]:
</div>

<div class="input_area" markdown="1">

```python
a.ndim
```

</div>

<div class="output_prompt">
Out&nbsp;[13]:
</div>




{:.output_data_text}

```
2
```



<div class="in_prompt">
In&nbsp;[14]:
</div>

<div class="input_area" markdown="1">

```python
a.shape
```

</div>

<div class="output_prompt">
Out&nbsp;[14]:
</div>




{:.output_data_text}

```
(3, 4)
```



<div class="in_prompt">
In&nbsp;[15]:
</div>

<div class="input_area" markdown="1">

```python
a
```

</div>

<div class="output_prompt">
Out&nbsp;[15]:
</div>




{:.output_data_text}

```
array([[ 1,  2,  3,  4],
       [ 5,  6,  7,  8],
       [ 9, 10, 11, 12]])
```



<div class="in_prompt">
In&nbsp;[16]:
</div>

<div class="input_area" markdown="1">

```python
print(a)
```

</div>

<div class="output_prompt">
Out&nbsp;[16]:
</div>

{:.output_stream}

```
[[ 1  2  3  4]
 [ 5  6  7  8]
 [ 9 10 11 12]]

```

<div class="in_prompt">
In&nbsp;[17]:
</div>

<div class="input_area" markdown="1">

```python
a[0, 3]
```

</div>

<div class="output_prompt">
Out&nbsp;[17]:
</div>




{:.output_data_text}

```
4
```



<div class="in_prompt">
In&nbsp;[18]:
</div>

<div class="input_area" markdown="1">

```python
a[:, 3]
```

</div>

<div class="output_prompt">
Out&nbsp;[18]:
</div>




{:.output_data_text}

```
array([ 4,  8, 12])
```



* scalar : 단일 element
* vector : 단일 차원의 array
* matrix : 2차원 array
* tensor : 3차원 이상의 array

# 기본 array 만드는 법

<div class="in_prompt">
In&nbsp;[19]:
</div>

<div class="input_area" markdown="1">

```python
np.array([[1,2],[3,4],[5,6]])
```

</div>

<div class="output_prompt">
Out&nbsp;[19]:
</div>




{:.output_data_text}

```
array([[1, 2],
       [3, 4],
       [5, 6]])
```



<div class="in_prompt">
In&nbsp;[20]:
</div>

<div class="input_area" markdown="1">

```python
np.array([[[1,2],[3,4],[5,6]],[[1,2],[3,4],[5,6]]])
```

</div>

<div class="output_prompt">
Out&nbsp;[20]:
</div>




{:.output_data_text}

```
array([[[1, 2],
        [3, 4],
        [5, 6]],

       [[1, 2],
        [3, 4],
        [5, 6]]])
```



<div class="in_prompt">
In&nbsp;[21]:
</div>

<div class="input_area" markdown="1">

```python
# 데이터 갯수가 다를 경우 list로 쪼개짐
np.array([[[1,2],[3,4],[5,6]],[[1,2],[3,4],[5,6,7]]])
```

</div>

<div class="output_prompt">
Out&nbsp;[21]:
</div>

{:.output_stream}

```
C:\Users\user\AppData\Local\Temp\ipykernel_15108\1008207123.py:2: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray.
  np.array([[[1,2],[3,4],[5,6]],[[1,2],[3,4],[5,6,7]]])

```




{:.output_data_text}

```
array([[list([1, 2]), list([3, 4]), list([5, 6])],
       [list([1, 2]), list([3, 4]), list([5, 6, 7])]], dtype=object)
```



<div class="in_prompt">
In&nbsp;[22]:
</div>

<div class="input_area" markdown="1">

```python
# 0으로 초기값을 지정하고 싶을 경우
np.zeros((2,3)) # np.zeros(shape, dtype=float, order='C', *, like=None)
```

</div>

<div class="output_prompt">
Out&nbsp;[22]:
</div>




{:.output_data_text}

```
array([[0., 0., 0.],
       [0., 0., 0.]])
```



<div class="in_prompt">
In&nbsp;[23]:
</div>

<div class="input_area" markdown="1">

```python
# 1로 초기값을 지정하고 싶을 경우
np.ones((2,3)) # np.ones(shape, dtype=None, order='C', *, like=None)
```

</div>

<div class="output_prompt">
Out&nbsp;[23]:
</div>




{:.output_data_text}

```
array([[1., 1., 1.],
       [1., 1., 1.]])
```



<div class="in_prompt">
In&nbsp;[24]:
</div>

<div class="input_area" markdown="1">

```python
# 초기값이 무작위, 메모리상태에 따라 달라짐 (초기화하는 과정을 하지 않으므로 속도가 쪼금 빠름)
np.empty((2,3)) # np.empty(shape, dtype=float, order='C', *, like=None)
```

</div>

<div class="output_prompt">
Out&nbsp;[24]:
</div>




{:.output_data_text}

```
array([[1., 1., 1.],
       [1., 1., 1.]])
```



<div class="in_prompt">
In&nbsp;[25]:
</div>

<div class="input_area" markdown="1">

```python
np.arange(6) # np.arange([start,] stop[, step,], dtype=None, *, like=None)
```

</div>

<div class="output_prompt">
Out&nbsp;[25]:
</div>




{:.output_data_text}

```
array([0, 1, 2, 3, 4, 5])
```



<div class="in_prompt">
In&nbsp;[26]:
</div>

<div class="input_area" markdown="1">

```python
# 시작값과 끝값 사이에 일정 갯수를 균등 간격으로 지정하고 싶을 경우
np.linspace(0, 10, num=5) # np.linspace(start, stop, num=50, endpoint=True, retstep=False, dtype=None, axis=0)
# parameter는 순서대로 넣을 경우 생략가능, 아닐경우 명시.
```

</div>

<div class="output_prompt">
Out&nbsp;[26]:
</div>




{:.output_data_text}

```
array([ 0. ,  2.5,  5. ,  7.5, 10. ])
```



<div class="in_prompt">
In&nbsp;[27]:
</div>

<div class="input_area" markdown="1">

```python
# 데이터 유형 지정
np.zeros((2,3), dtype=np.int8) # int8 ~ int64 : 1바이트 ~ 8바이트로 표현하는 int. 적절한 data의 크기를 잡아줘야 한다. default는 64
```

</div>

<div class="output_prompt">
Out&nbsp;[27]:
</div>




{:.output_data_text}

```
array([[0, 0, 0],
       [0, 0, 0]], dtype=int8)
```



# Element의 정렬과 추가

## np.sort()

<div class="in_prompt">
In&nbsp;[28]:
</div>

<div class="input_area" markdown="1">

```python
arr = np.array([2, 1, 5, 3, 7, 4, 6, 8])
```

</div>

<div class="in_prompt">
In&nbsp;[29]:
</div>

<div class="input_area" markdown="1">

```python
np.sort(arr) # np.sort(a, axis=-1, kind=None, order=None) # axis는 정렬할 기준(-1은 끝값, 차원이 늘어도 무조건 열이 기준이 됨)
```

</div>

<div class="output_prompt">
Out&nbsp;[29]:
</div>




{:.output_data_text}

```
array([1, 2, 3, 4, 5, 6, 7, 8])
```



<div class="in_prompt">
In&nbsp;[30]:
</div>

<div class="input_area" markdown="1">

```python
# 내림차순이 필요한 경우
np.sort(arr)[::-1] # 처음부터:끝까지:역순
```

</div>

<div class="output_prompt">
Out&nbsp;[30]:
</div>




{:.output_data_text}

```
array([8, 7, 6, 5, 4, 3, 2, 1])
```



<div class="in_prompt">
In&nbsp;[31]:
</div>

<div class="input_area" markdown="1">

```python
# 2차원 정렬
a = np.array([[1,4],[3,1]])
a
```

</div>

<div class="output_prompt">
Out&nbsp;[31]:
</div>




{:.output_data_text}

```
array([[1, 4],
       [3, 1]])
```



<div class="in_prompt">
In&nbsp;[32]:
</div>

<div class="input_area" markdown="1">

```python
np.sort(a)
# default인 axis=-1는 shape에서 나온 2x2에서 -1(끝)인 열기준(column을 묶어 정렬 --방향)
```

</div>

<div class="output_prompt">
Out&nbsp;[32]:
</div>




{:.output_data_text}

```
array([[1, 4],
       [1, 3]])
```



<div class="in_prompt">
In&nbsp;[33]:
</div>

<div class="input_area" markdown="1">

```python
np.sort(a, axis=1)
```

</div>

<div class="output_prompt">
Out&nbsp;[33]:
</div>




{:.output_data_text}

```
array([[1, 4],
       [1, 3]])
```



<div class="in_prompt">
In&nbsp;[34]:
</div>

<div class="input_area" markdown="1">

```python
np.sort(a, axis=0)
# axis=0은 2x2에서 0인 행기준(row를 묶어 정렬 |방향)
```

</div>

<div class="output_prompt">
Out&nbsp;[34]:
</div>




{:.output_data_text}

```
array([[1, 1],
       [3, 4]])
```



* argsort: 지정된 축을 따른 간접 정렬

* lexsort: 여러 키에 대한 간접 안정 정렬

* searchsorted: 정렬된 array에서 element 찾기

* partition: 부분 정렬

### np.argsort()

<div class="in_prompt">
In&nbsp;[35]:
</div>

<div class="input_area" markdown="1">

```python
x = np.array([3, 1, 2])
```

</div>

<div class="in_prompt">
In&nbsp;[36]:
</div>

<div class="input_area" markdown="1">

```python
# 인덱스 값을 리턴
np.argsort(x) # np.argsort(a, axis=-1, kind=None, order=None)
```

</div>

<div class="output_prompt">
Out&nbsp;[36]:
</div>




{:.output_data_text}

```
array([1, 2, 0], dtype=int64)
```



<div class="in_prompt">
In&nbsp;[37]:
</div>

<div class="input_area" markdown="1">

```python
np.argmax(x) # 딥러닝에서 사용 # arg가 붙은 함수는 idx를 리턴한다!
```

</div>

<div class="output_prompt">
Out&nbsp;[37]:
</div>




{:.output_data_text}

```
0
```



<div class="in_prompt">
In&nbsp;[38]:
</div>

<div class="input_area" markdown="1">

```python
# 2차원일 경우
x = np.array([[0, 3], [2, 2]])
x
```

</div>

<div class="output_prompt">
Out&nbsp;[38]:
</div>




{:.output_data_text}

```
array([[0, 3],
       [2, 2]])
```



<div class="in_prompt">
In&nbsp;[39]:
</div>

<div class="input_area" markdown="1">

```python
np.argsort(x, axis=-1)
```

</div>

<div class="output_prompt">
Out&nbsp;[39]:
</div>




{:.output_data_text}

```
array([[0, 1],
       [0, 1]], dtype=int64)
```



<div class="in_prompt">
In&nbsp;[40]:
</div>

<div class="input_area" markdown="1">

```python
np.argsort(x, axis=1)
```

</div>

<div class="output_prompt">
Out&nbsp;[40]:
</div>




{:.output_data_text}

```
array([[0, 1],
       [0, 1]], dtype=int64)
```



<div class="in_prompt">
In&nbsp;[41]:
</div>

<div class="input_area" markdown="1">

```python
np.argsort(x, axis=0)
```

</div>

<div class="output_prompt">
Out&nbsp;[41]:
</div>




{:.output_data_text}

```
array([[0, 1],
       [1, 0]], dtype=int64)
```



## np.concatenate()

<div class="in_prompt">
In&nbsp;[42]:
</div>

<div class="input_area" markdown="1">

```python
a = np.array([1, 2, 3, 4])
b = np.array([5, 6, 7, 8])
```

</div>

<div class="in_prompt">
In&nbsp;[43]:
</div>

<div class="input_area" markdown="1">

```python
np.concatenate((a, b)) # concatenate((a1, a2, ...), axis=0, out=None, dtype=None, casting="same_kind")
```

</div>

<div class="output_prompt">
Out&nbsp;[43]:
</div>




{:.output_data_text}

```
array([1, 2, 3, 4, 5, 6, 7, 8])
```



<div class="in_prompt">
In&nbsp;[44]:
</div>

<div class="input_area" markdown="1">

```python
# 2차원일 경우
a = np.array([[1, 2, 3, 4]])
b = np.array([[5, 6, 7, 8]])
```

</div>

<div class="in_prompt">
In&nbsp;[45]:
</div>

<div class="input_area" markdown="1">

```python
np.concatenate((a, b), axis=0)
```

</div>

<div class="output_prompt">
Out&nbsp;[45]:
</div>




{:.output_data_text}

```
array([[1, 2, 3, 4],
       [5, 6, 7, 8]])
```



<div class="in_prompt">
In&nbsp;[46]:
</div>

<div class="input_area" markdown="1">

```python
np.concatenate((a, b), axis=1)
```

</div>

<div class="output_prompt">
Out&nbsp;[46]:
</div>




{:.output_data_text}

```
array([[1, 2, 3, 4, 5, 6, 7, 8]])
```



<div class="in_prompt">
In&nbsp;[47]:
</div>

<div class="input_area" markdown="1">

```python
# 3차원일 경우
a = np.array([[[1, 2, 3, 4]]])
b = np.array([[[5, 6, 7, 8]]])
```

</div>

<div class="in_prompt">
In&nbsp;[48]:
</div>

<div class="input_area" markdown="1">

```python
np.concatenate((a, b), axis=0)
```

</div>

<div class="output_prompt">
Out&nbsp;[48]:
</div>




{:.output_data_text}

```
array([[[1, 2, 3, 4]],

       [[5, 6, 7, 8]]])
```



<div class="in_prompt">
In&nbsp;[49]:
</div>

<div class="input_area" markdown="1">

```python
np.concatenate((a, b), axis=1)
```

</div>

<div class="output_prompt">
Out&nbsp;[49]:
</div>




{:.output_data_text}

```
array([[[1, 2, 3, 4],
        [5, 6, 7, 8]]])
```



<div class="in_prompt">
In&nbsp;[50]:
</div>

<div class="input_area" markdown="1">

```python
np.concatenate((a, b), axis=2)
```

</div>

<div class="output_prompt">
Out&nbsp;[50]:
</div>




{:.output_data_text}

```
array([[[1, 2, 3, 4, 5, 6, 7, 8]]])
```



# Array의 모양과 크기

<div class="in_prompt">
In&nbsp;[51]:
</div>

<div class="input_area" markdown="1">

```python
# axes or dimensions
a.ndim
```

</div>

<div class="output_prompt">
Out&nbsp;[51]:
</div>




{:.output_data_text}

```
3
```



<div class="in_prompt">
In&nbsp;[52]:
</div>

<div class="input_area" markdown="1">

```python
# 각 dimension에 몇개의 element가 있는지
a.shape
```

</div>

<div class="output_prompt">
Out&nbsp;[52]:
</div>




{:.output_data_text}

```
(1, 1, 4)
```



<div class="in_prompt">
In&nbsp;[53]:
</div>

<div class="input_area" markdown="1">

```python
# element의 총 갯수
a.size
```

</div>

<div class="output_prompt">
Out&nbsp;[53]:
</div>




{:.output_data_text}

```
4
```



<div class="in_prompt">
In&nbsp;[54]:
</div>

<div class="input_area" markdown="1">

```python
np.concatenate((a, b), axis=0).shape # method chaining
```

</div>

<div class="output_prompt">
Out&nbsp;[54]:
</div>




{:.output_data_text}

```
(2, 1, 4)
```



# Array의 reshape

<div class="in_prompt">
In&nbsp;[55]:
</div>

<div class="input_area" markdown="1">

```python
a = np.arange(6)
a
```

</div>

<div class="output_prompt">
Out&nbsp;[55]:
</div>




{:.output_data_text}

```
array([0, 1, 2, 3, 4, 5])
```



<div class="in_prompt">
In&nbsp;[56]:
</div>

<div class="input_area" markdown="1">

```python
# array의 데이터를 변경하지 않고 모양을 변경
a.reshape(3, 2) # .reshape(shape, order='C')
```

</div>

<div class="output_prompt">
Out&nbsp;[56]:
</div>




{:.output_data_text}

```
array([[0, 1],
       [2, 3],
       [4, 5]])
```



<div class="in_prompt">
In&nbsp;[57]:
</div>

<div class="input_area" markdown="1">

```python
a.reshape(2, 3)
```

</div>

<div class="output_prompt">
Out&nbsp;[57]:
</div>




{:.output_data_text}

```
array([[0, 1, 2],
       [3, 4, 5]])
```



<div class="in_prompt">
In&nbsp;[58]:
</div>

<div class="input_area" markdown="1">

```python
np.reshape(a, (2, 3)) # np.reshape(a, newshape, order='C')
```

</div>

<div class="output_prompt">
Out&nbsp;[58]:
</div>




{:.output_data_text}

```
array([[0, 1, 2],
       [3, 4, 5]])
```



# Array에 새 axis 추가

## np.newaxis

<div class="in_prompt">
In&nbsp;[59]:
</div>

<div class="input_area" markdown="1">

```python
a = np.array([1, 2, 3, 4, 5, 6])
a.shape
```

</div>

<div class="output_prompt">
Out&nbsp;[59]:
</div>




{:.output_data_text}

```
(6,)
```



<div class="in_prompt">
In&nbsp;[60]:
</div>

<div class="input_area" markdown="1">

```python
a2 = a[np.newaxis, :]
a2
```

</div>

<div class="output_prompt">
Out&nbsp;[60]:
</div>




{:.output_data_text}

```
array([[1, 2, 3, 4, 5, 6]])
```



<div class="in_prompt">
In&nbsp;[61]:
</div>

<div class="input_area" markdown="1">

```python
a2.shape
```

</div>

<div class="output_prompt">
Out&nbsp;[61]:
</div>




{:.output_data_text}

```
(1, 6)
```



<div class="in_prompt">
In&nbsp;[62]:
</div>

<div class="input_area" markdown="1">

```python
a3 = a[:, np.newaxis]
a3
```

</div>

<div class="output_prompt">
Out&nbsp;[62]:
</div>




{:.output_data_text}

```
array([[1],
       [2],
       [3],
       [4],
       [5],
       [6]])
```



<div class="in_prompt">
In&nbsp;[63]:
</div>

<div class="input_area" markdown="1">

```python
a3.shape
```

</div>

<div class="output_prompt">
Out&nbsp;[63]:
</div>




{:.output_data_text}

```
(6, 1)
```



## np.expand_dims()

<div class="in_prompt">
In&nbsp;[64]:
</div>

<div class="input_area" markdown="1">

```python
b = np.expand_dims(a, axis=0) # np.expand_dims(a, axis) # axis에 어디에 차원을 늘릴지 지정 가능
b
```

</div>

<div class="output_prompt">
Out&nbsp;[64]:
</div>




{:.output_data_text}

```
array([[1, 2, 3, 4, 5, 6]])
```



<div class="in_prompt">
In&nbsp;[65]:
</div>

<div class="input_area" markdown="1">

```python
b2 = np.expand_dims(a, axis=1)
b2
```

</div>

<div class="output_prompt">
Out&nbsp;[65]:
</div>




{:.output_data_text}

```
array([[1],
       [2],
       [3],
       [4],
       [5],
       [6]])
```



<div class="in_prompt">
In&nbsp;[66]:
</div>

<div class="input_area" markdown="1">

```python
# 2차원일 경우
aa = a3.reshape((3, 2))
aa
```

</div>

<div class="output_prompt">
Out&nbsp;[66]:
</div>




{:.output_data_text}

```
array([[1, 2],
       [3, 4],
       [5, 6]])
```



<div class="in_prompt">
In&nbsp;[67]:
</div>

<div class="input_area" markdown="1">

```python
a4 = np.expand_dims(aa, axis=0)
a4.shape
```

</div>

<div class="output_prompt">
Out&nbsp;[67]:
</div>




{:.output_data_text}

```
(1, 3, 2)
```



<div class="in_prompt">
In&nbsp;[68]:
</div>

<div class="input_area" markdown="1">

```python
a4 = np.expand_dims(aa, axis=1)
a4.shape
```

</div>

<div class="output_prompt">
Out&nbsp;[68]:
</div>




{:.output_data_text}

```
(3, 1, 2)
```



<div class="in_prompt">
In&nbsp;[69]:
</div>

<div class="input_area" markdown="1">

```python
a4 = np.expand_dims(aa, axis=2)
a4.shape
```

</div>

<div class="output_prompt">
Out&nbsp;[69]:
</div>




{:.output_data_text}

```
(3, 2, 1)
```



# Indexing과 slicing

<div class="in_prompt">
In&nbsp;[70]:
</div>

<div class="input_area" markdown="1">

```python
data = np.array([1, 2, 3])
```

</div>

<div class="in_prompt">
In&nbsp;[71]:
</div>

<div class="input_area" markdown="1">

```python
data[1]
```

</div>

<div class="output_prompt">
Out&nbsp;[71]:
</div>




{:.output_data_text}

```
2
```



<div class="in_prompt">
In&nbsp;[72]:
</div>

<div class="input_area" markdown="1">

```python
data[0:2]
```

</div>

<div class="output_prompt">
Out&nbsp;[72]:
</div>




{:.output_data_text}

```
array([1, 2])
```



<div class="in_prompt">
In&nbsp;[73]:
</div>

<div class="input_area" markdown="1">

```python
data[1:]
```

</div>

<div class="output_prompt">
Out&nbsp;[73]:
</div>




{:.output_data_text}

```
array([2, 3])
```



<div class="in_prompt">
In&nbsp;[74]:
</div>

<div class="input_area" markdown="1">

```python
data[-2:]
```

</div>

<div class="output_prompt">
Out&nbsp;[74]:
</div>




{:.output_data_text}

```
array([2, 3])
```



## 조건추가

<div class="in_prompt">
In&nbsp;[75]:
</div>

<div class="input_area" markdown="1">

```python
a = np.array([[1, 2, 3, 4], [5, 6, 7, 8], [9, 10, 11, 12]])
a
```

</div>

<div class="output_prompt">
Out&nbsp;[75]:
</div>




{:.output_data_text}

```
array([[ 1,  2,  3,  4],
       [ 5,  6,  7,  8],
       [ 9, 10, 11, 12]])
```



<div class="in_prompt">
In&nbsp;[76]:
</div>

<div class="input_area" markdown="1">

```python
print("a.ndim: {}, a.shape: {}".format(a.ndim, a.shape))
```

</div>

<div class="output_prompt">
Out&nbsp;[76]:
</div>

{:.output_stream}

```
a.ndim: 2, a.shape: (3, 4)

```

<div class="in_prompt">
In&nbsp;[77]:
</div>

<div class="input_area" markdown="1">

```python
a[a>=5]
```

</div>

<div class="output_prompt">
Out&nbsp;[77]:
</div>




{:.output_data_text}

```
array([ 5,  6,  7,  8,  9, 10, 11, 12])
```



<div class="in_prompt">
In&nbsp;[78]:
</div>

<div class="input_area" markdown="1">

```python
a[a%2==0]
```

</div>

<div class="output_prompt">
Out&nbsp;[78]:
</div>




{:.output_data_text}

```
array([ 2,  4,  6,  8, 10, 12])
```



<div class="in_prompt">
In&nbsp;[79]:
</div>

<div class="input_area" markdown="1">

```python
a[(a>2) & (a<11)] # 모호성 때문에 연산자 우선순위가 있더라도 괄호로 명확히 해야함
```

</div>

<div class="output_prompt">
Out&nbsp;[79]:
</div>




{:.output_data_text}

```
array([ 3,  4,  5,  6,  7,  8,  9, 10])
```



<div class="in_prompt">
In&nbsp;[80]:
</div>

<div class="input_area" markdown="1">

```python
a[(a>5) | (a==5)]
```

</div>

<div class="output_prompt">
Out&nbsp;[80]:
</div>




{:.output_data_text}

```
array([ 5,  6,  7,  8,  9, 10, 11, 12])
```



<div class="in_prompt">
In&nbsp;[81]:
</div>

<div class="input_area" markdown="1">

```python
b = np.nonzero(a<5) # 조건에 맞는 행열값을 리턴 (각 차원에 대해 하나씩 array의 tuple이 리턴된다)
b
```

</div>

<div class="output_prompt">
Out&nbsp;[81]:
</div>




{:.output_data_text}

```
(array([0, 0, 0, 0], dtype=int64), array([0, 1, 2, 3], dtype=int64))
```



<div class="in_prompt">
In&nbsp;[82]:
</div>

<div class="input_area" markdown="1">

```python
list(zip(b[0], b[1])) # zip: 같은 위치의 값을 묶어줌, 보통 list와 같이 사용
```

</div>

<div class="output_prompt">
Out&nbsp;[82]:
</div>




{:.output_data_text}

```
[(0, 0), (0, 1), (0, 2), (0, 3)]
```



# 기존 데이터로 array 만들기

<div class="in_prompt">
In&nbsp;[83]:
</div>

<div class="input_area" markdown="1">

```python
a = np.array([1,  2,  3,  4,  5,  6,  7,  8,  9, 10])
```

</div>

<div class="in_prompt">
In&nbsp;[84]:
</div>

<div class="input_area" markdown="1">

```python
# view 생성
arr1 = a[3:8] # 값을 복사하는 것이 아니라 참조를 하고 있기에 이 array을 변경하면 원 array도 바뀐다!(얕은 복사)
arr1
```

</div>

<div class="output_prompt">
Out&nbsp;[84]:
</div>




{:.output_data_text}

```
array([4, 5, 6, 7, 8])
```



<div class="in_prompt">
In&nbsp;[85]:
</div>

<div class="input_area" markdown="1">

```python
a
```

</div>

<div class="output_prompt">
Out&nbsp;[85]:
</div>




{:.output_data_text}

```
array([ 1,  2,  3,  4,  5,  6,  7,  8,  9, 10])
```



<div class="in_prompt">
In&nbsp;[86]:
</div>

<div class="input_area" markdown="1">

```python
arr1[0] = 14
```

</div>

<div class="in_prompt">
In&nbsp;[87]:
</div>

<div class="input_area" markdown="1">

```python
a
```

</div>

<div class="output_prompt">
Out&nbsp;[87]:
</div>




{:.output_data_text}

```
array([ 1,  2,  3, 14,  5,  6,  7,  8,  9, 10])
```



<div class="in_prompt">
In&nbsp;[88]:
</div>

<div class="input_area" markdown="1">

```python
a1 = np.array([[1, 1],
               [2, 2]])
a2 = np.array([[3, 3],
               [4, 4]])
# 위아래로 붙이려면 열이 맞아야 하고 좌우로 붙이려면 행이 맞아야 한다
```

</div>

<div class="in_prompt">
In&nbsp;[89]:
</div>

<div class="input_area" markdown="1">

```python
np.concatenate((a1, a2), axis=1)
```

</div>

<div class="output_prompt">
Out&nbsp;[89]:
</div>




{:.output_data_text}

```
array([[1, 1, 3, 3],
       [2, 2, 4, 4]])
```



<div class="in_prompt">
In&nbsp;[90]:
</div>

<div class="input_area" markdown="1">

```python
# vertical 쌓기
np.vstack((a1, a2))
```

</div>

<div class="output_prompt">
Out&nbsp;[90]:
</div>




{:.output_data_text}

```
array([[1, 1],
       [2, 2],
       [3, 3],
       [4, 4]])
```



<div class="in_prompt">
In&nbsp;[91]:
</div>

<div class="input_area" markdown="1">

```python
# horizontal 쌓기
np.hstack((a1, a2))
```

</div>

<div class="output_prompt">
Out&nbsp;[91]:
</div>




{:.output_data_text}

```
array([[1, 1, 3, 3],
       [2, 2, 4, 4]])
```



<div class="in_prompt">
In&nbsp;[92]:
</div>

<div class="input_area" markdown="1">

```python
# horizontal 분리(수평으로 된 것을 분리: |로 자름)
x = np.arange(1, 25).reshape(2, 12)
x
```

</div>

<div class="output_prompt">
Out&nbsp;[92]:
</div>




{:.output_data_text}

```
array([[ 1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12],
       [13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]])
```



<div class="in_prompt">
In&nbsp;[93]:
</div>

<div class="input_area" markdown="1">

```python
np.hsplit(x, 3)
```

</div>

<div class="output_prompt">
Out&nbsp;[93]:
</div>




{:.output_data_text}

```
[array([[ 1,  2,  3,  4],
        [13, 14, 15, 16]]),
 array([[ 5,  6,  7,  8],
        [17, 18, 19, 20]]),
 array([[ 9, 10, 11, 12],
        [21, 22, 23, 24]])]
```



<div class="in_prompt">
In&nbsp;[94]:
</div>

<div class="input_area" markdown="1">

```python
np.hsplit(x, (3, 4)) # idx 3과 4앞에서 자름
```

</div>

<div class="output_prompt">
Out&nbsp;[94]:
</div>




{:.output_data_text}

```
[array([[ 1,  2,  3],
        [13, 14, 15]]),
 array([[ 4],
        [16]]),
 array([[ 5,  6,  7,  8,  9, 10, 11, 12],
        [17, 18, 19, 20, 21, 22, 23, 24]])]
```



* 얕은 복사(슬라이싱)가 아닌 원본을 두고 복사본 생성 : copy()

<div class="in_prompt">
In&nbsp;[95]:
</div>

<div class="input_area" markdown="1">

```python
b2 = a.copy()
print(a)
print(b2)
```

</div>

<div class="output_prompt">
Out&nbsp;[95]:
</div>

{:.output_stream}

```
[ 1  2  3 14  5  6  7  8  9 10]
[ 1  2  3 14  5  6  7  8  9 10]

```

<div class="in_prompt">
In&nbsp;[96]:
</div>

<div class="input_area" markdown="1">

```python
b2[3] = 4
print(a)
print(b2)
```

</div>

<div class="output_prompt">
Out&nbsp;[96]:
</div>

{:.output_stream}

```
[ 1  2  3 14  5  6  7  8  9 10]
[ 1  2  3  4  5  6  7  8  9 10]

```

# 기본 array 연산

<div class="in_prompt">
In&nbsp;[97]:
</div>

<div class="input_area" markdown="1">

```python
data = np.array([1, 2])
ones = np.ones(2, dtype=int)
print(data)
print(ones)
```

</div>

<div class="output_prompt">
Out&nbsp;[97]:
</div>

{:.output_stream}

```
[1 2]
[1 1]

```

<div class="in_prompt">
In&nbsp;[98]:
</div>

<div class="input_area" markdown="1">

```python
data + ones
```

</div>

<div class="output_prompt">
Out&nbsp;[98]:
</div>




{:.output_data_text}

```
array([2, 3])
```



<div class="in_prompt">
In&nbsp;[99]:
</div>

<div class="input_area" markdown="1">

```python
data - ones
```

</div>

<div class="output_prompt">
Out&nbsp;[99]:
</div>




{:.output_data_text}

```
array([0, 1])
```



<div class="in_prompt">
In&nbsp;[100]:
</div>

<div class="input_area" markdown="1">

```python
data * data
```

</div>

<div class="output_prompt">
Out&nbsp;[100]:
</div>




{:.output_data_text}

```
array([1, 4])
```



<div class="in_prompt">
In&nbsp;[101]:
</div>

<div class="input_area" markdown="1">

```python
data / data
```

</div>

<div class="output_prompt">
Out&nbsp;[101]:
</div>




{:.output_data_text}

```
array([1., 1.])
```



<div class="in_prompt">
In&nbsp;[102]:
</div>

<div class="input_area" markdown="1">

```python
a = np.array([1, 2, 3, 4])
a.sum()
```

</div>

<div class="output_prompt">
Out&nbsp;[102]:
</div>




{:.output_data_text}

```
10
```



<div class="in_prompt">
In&nbsp;[103]:
</div>

<div class="input_area" markdown="1">

```python
b = np.array([[1, 1], [2, 2]])
b.sum() # .sum(axis=None, dtype=None, out=None, keepdims=False, initial=0, where=True)
```

</div>

<div class="output_prompt">
Out&nbsp;[103]:
</div>




{:.output_data_text}

```
6
```



<div class="in_prompt">
In&nbsp;[104]:
</div>

<div class="input_area" markdown="1">

```python
b
```

</div>

<div class="output_prompt">
Out&nbsp;[104]:
</div>




{:.output_data_text}

```
array([[1, 1],
       [2, 2]])
```



<div class="in_prompt">
In&nbsp;[105]:
</div>

<div class="input_area" markdown="1">

```python
b.sum(0) # axis=0
```

</div>

<div class="output_prompt">
Out&nbsp;[105]:
</div>




{:.output_data_text}

```
array([3, 3])
```



<div class="in_prompt">
In&nbsp;[106]:
</div>

<div class="input_area" markdown="1">

```python
b.sum(1)
```

</div>

<div class="output_prompt">
Out&nbsp;[106]:
</div>




{:.output_data_text}

```
array([2, 4])
```



# Broadcast

* array와 단일 숫자 사이의 연산(벡터와 스칼라 간의 연산이라고도 함) 또는 두 개의 서로 다른 크기의 array 간에 연산을 수행

<div class="in_prompt">
In&nbsp;[107]:
</div>

<div class="input_area" markdown="1">

```python
data = np.array([1.0, 2.0])
data
```

</div>

<div class="output_prompt">
Out&nbsp;[107]:
</div>




{:.output_data_text}

```
array([1., 2.])
```



<div class="in_prompt">
In&nbsp;[108]:
</div>

<div class="input_area" markdown="1">

```python
data * 1.6 # 1.6(스칼라;scalar값)이 확장 [1.6, 1.6] 하여 연산된다
```

</div>

<div class="output_prompt">
Out&nbsp;[108]:
</div>




{:.output_data_text}

```
array([1.6, 3.2])
```



## 일반 broadcast 규칙

* 두 개의 array에서 작업할 때 Numpy는 element 별로 모양을 비교한다. 후행(즉, 맨 오른쪽) 차원에서 시작하여 왼쪽으로 작동한다.
* 두 차원은 다음과 같은 경우 호환된다.
    1. 같을 때
    2. 그 중 하나가 1일 때
* 이러한 조건이 충족되지 않으면 array에 호환되지 않는 모양이 있음을 나타내는 예외가 발생<br> (ValueError: operands could not be broadcast together)

<div class="in_prompt">
In&nbsp;[109]:
</div>

<div class="input_area" markdown="1">

```python
a = np.array([[ 0.0,  0.0,  0.0],
              [10.0, 10.0, 10.0],
              [20.0, 20.0, 20.0],
              [30.0, 30.0, 30.0]])
a.shape
```

</div>

<div class="output_prompt">
Out&nbsp;[109]:
</div>




{:.output_data_text}

```
(4, 3)
```



<div class="in_prompt">
In&nbsp;[110]:
</div>

<div class="input_area" markdown="1">

```python
b = np.array([1.0, 2.0, 3.0])
b.shape
```

</div>

<div class="output_prompt">
Out&nbsp;[110]:
</div>




{:.output_data_text}

```
(3,)
```



<div class="in_prompt">
In&nbsp;[111]:
</div>

<div class="input_area" markdown="1">

```python
a + b
```

</div>

<div class="output_prompt">
Out&nbsp;[111]:
</div>




{:.output_data_text}

```
array([[ 1.,  2.,  3.],
       [11., 12., 13.],
       [21., 22., 23.],
       [31., 32., 33.]])
```



<div class="in_prompt">
In&nbsp;[112]:
</div>

<div class="input_area" markdown="1">

```python
c = np.array([8])
c.shape
```

</div>

<div class="output_prompt">
Out&nbsp;[112]:
</div>




{:.output_data_text}

```
(1,)
```



<div class="in_prompt">
In&nbsp;[113]:
</div>

<div class="input_area" markdown="1">

```python
a * c
```

</div>

<div class="output_prompt">
Out&nbsp;[113]:
</div>




{:.output_data_text}

```
array([[  0.,   0.,   0.],
       [ 80.,  80.,  80.],
       [160., 160., 160.],
       [240., 240., 240.]])
```



# 유용한 array 연산

<div class="in_prompt">
In&nbsp;[114]:
</div>

<div class="input_area" markdown="1">

```python
data
```

</div>

<div class="output_prompt">
Out&nbsp;[114]:
</div>




{:.output_data_text}

```
array([1., 2.])
```



<div class="in_prompt">
In&nbsp;[115]:
</div>

<div class="input_area" markdown="1">

```python
data.max()
```

</div>

<div class="output_prompt">
Out&nbsp;[115]:
</div>




{:.output_data_text}

```
2.0
```



<div class="in_prompt">
In&nbsp;[116]:
</div>

<div class="input_area" markdown="1">

```python
data.min()
```

</div>

<div class="output_prompt">
Out&nbsp;[116]:
</div>




{:.output_data_text}

```
1.0
```



<div class="in_prompt">
In&nbsp;[117]:
</div>

<div class="input_area" markdown="1">

```python
data.sum()
```

</div>

<div class="output_prompt">
Out&nbsp;[117]:
</div>




{:.output_data_text}

```
3.0
```



# Matrix(행렬) 생성

<div class="in_prompt">
In&nbsp;[118]:
</div>

<div class="input_area" markdown="1">

```python
data = np.array([[1, 2], [3, 4], [5, 6]])
data
```

</div>

<div class="output_prompt">
Out&nbsp;[118]:
</div>




{:.output_data_text}

```
array([[1, 2],
       [3, 4],
       [5, 6]])
```



# Random number 생성

<div class="in_prompt">
In&nbsp;[119]:
</div>

<div class="input_area" markdown="1">

```python
rng = np.random.default_rng(1) # seed값이 같으면 같은 값이 나온다!
```

</div>

<div class="in_prompt">
In&nbsp;[120]:
</div>

<div class="input_area" markdown="1">

```python
rng.random(3)
```

</div>

<div class="output_prompt">
Out&nbsp;[120]:
</div>




{:.output_data_text}

```
array([0.51182162, 0.9504637 , 0.14415961])
```



<div class="in_prompt">
In&nbsp;[121]:
</div>

<div class="input_area" markdown="1">

```python
rng.integers(1, 5) # integers(low, high=None, size=None, dtype=np.int64, endpoint=False)
```

</div>

<div class="output_prompt">
Out&nbsp;[121]:
</div>




{:.output_data_text}

```
4
```



<div class="in_prompt">
In&nbsp;[122]:
</div>

<div class="input_area" markdown="1">

```python
rng.integers(1, 5, endpoint=True)
```

</div>

<div class="output_prompt">
Out&nbsp;[122]:
</div>




{:.output_data_text}

```
5
```



# Unique items와 count

<div class="in_prompt">
In&nbsp;[123]:
</div>

<div class="input_area" markdown="1">

```python
a = np.array([11, 11, 12, 13, 14, 15, 16, 17, 12, 13, 11, 14, 18, 19, 20])
a
```

</div>

<div class="output_prompt">
Out&nbsp;[123]:
</div>




{:.output_data_text}

```
array([11, 11, 12, 13, 14, 15, 16, 17, 12, 13, 11, 14, 18, 19, 20])
```



<div class="in_prompt">
In&nbsp;[124]:
</div>

<div class="input_area" markdown="1">

```python
np.unique(a, return_index=True) # np.unique(ar, return_index=False, return_inverse=False, return_counts=False, axis=None)
```

</div>

<div class="output_prompt">
Out&nbsp;[124]:
</div>




{:.output_data_text}

```
(array([11, 12, 13, 14, 15, 16, 17, 18, 19, 20]),
 array([ 0,  2,  3,  4,  5,  6,  7, 12, 13, 14], dtype=int64))
```



<div class="in_prompt">
In&nbsp;[125]:
</div>

<div class="input_area" markdown="1">

```python
np.unique(a, return_inverse=True) # inverse는 원본 array의 값을 return된 array의 값에 해당하는 index값을 표시
```

</div>

<div class="output_prompt">
Out&nbsp;[125]:
</div>




{:.output_data_text}

```
(array([11, 12, 13, 14, 15, 16, 17, 18, 19, 20]),
 array([0, 0, 1, 2, 3, 4, 5, 6, 1, 2, 0, 3, 7, 8, 9], dtype=int64))
```



<div class="in_prompt">
In&nbsp;[126]:
</div>

<div class="input_area" markdown="1">

```python
np.unique(a, return_counts=True) # 중복 count
```

</div>

<div class="output_prompt">
Out&nbsp;[126]:
</div>




{:.output_data_text}

```
(array([11, 12, 13, 14, 15, 16, 17, 18, 19, 20]),
 array([3, 2, 2, 2, 1, 1, 1, 1, 1, 1], dtype=int64))
```



# Matrix의 transposing과 reshaping

<div class="in_prompt">
In&nbsp;[127]:
</div>

<div class="input_area" markdown="1">

```python
data = np.arange(1, 7).reshape(2, 3)
data
```

</div>

<div class="output_prompt">
Out&nbsp;[127]:
</div>




{:.output_data_text}

```
array([[1, 2, 3],
       [4, 5, 6]])
```



<div class="in_prompt">
In&nbsp;[128]:
</div>

<div class="input_area" markdown="1">

```python
# 행과 열을 바꿈
data.transpose()
```

</div>

<div class="output_prompt">
Out&nbsp;[128]:
</div>




{:.output_data_text}

```
array([[1, 4],
       [2, 5],
       [3, 6]])
```



<div class="in_prompt">
In&nbsp;[129]:
</div>

<div class="input_area" markdown="1">

```python
data.T
```

</div>

<div class="output_prompt">
Out&nbsp;[129]:
</div>




{:.output_data_text}

```
array([[1, 4],
       [2, 5],
       [3, 6]])
```



# Array 뒤집기

<div class="in_prompt">
In&nbsp;[130]:
</div>

<div class="input_area" markdown="1">

```python
arr = np.array([1, 2, 3, 4, 9, 5, 6, 7, 8])
arr
```

</div>

<div class="output_prompt">
Out&nbsp;[130]:
</div>




{:.output_data_text}

```
array([1, 2, 3, 4, 9, 5, 6, 7, 8])
```



<div class="in_prompt">
In&nbsp;[131]:
</div>

<div class="input_area" markdown="1">

```python
np.flip(arr)
```

</div>

<div class="output_prompt">
Out&nbsp;[131]:
</div>




{:.output_data_text}

```
array([8, 7, 6, 5, 9, 4, 3, 2, 1])
```



<div class="in_prompt">
In&nbsp;[132]:
</div>

<div class="input_area" markdown="1">

```python
# 2차원의 경우
arr_2d = np.array([[1, 2, 3, 4], [5, 6, 7, 8], [9, 10, 11, 12]])
arr_2d
```

</div>

<div class="output_prompt">
Out&nbsp;[132]:
</div>




{:.output_data_text}

```
array([[ 1,  2,  3,  4],
       [ 5,  6,  7,  8],
       [ 9, 10, 11, 12]])
```



<div class="in_prompt">
In&nbsp;[133]:
</div>

<div class="input_area" markdown="1">

```python
np.flip(arr_2d)
```

</div>

<div class="output_prompt">
Out&nbsp;[133]:
</div>




{:.output_data_text}

```
array([[12, 11, 10,  9],
       [ 8,  7,  6,  5],
       [ 4,  3,  2,  1]])
```



<div class="in_prompt">
In&nbsp;[134]:
</div>

<div class="input_area" markdown="1">

```python
np.flip(arr_2d, axis=0) # 행만 뒤집음
```

</div>

<div class="output_prompt">
Out&nbsp;[134]:
</div>




{:.output_data_text}

```
array([[ 9, 10, 11, 12],
       [ 5,  6,  7,  8],
       [ 1,  2,  3,  4]])
```



<div class="in_prompt">
In&nbsp;[135]:
</div>

<div class="input_area" markdown="1">

```python
np.flip(arr_2d, axis=1) # 열만 뒤집음 
```

</div>

<div class="output_prompt">
Out&nbsp;[135]:
</div>




{:.output_data_text}

```
array([[ 4,  3,  2,  1],
       [ 8,  7,  6,  5],
       [12, 11, 10,  9]])
```



# 다차원 array의 reshaping과 flattening

* .flatten() : 1차원으로 평탄화
* .ravel() : 1차원으로 평탄화, 복사본을 생성하지 않으므로 메모리 효율적(얕은 복사)

<div class="in_prompt">
In&nbsp;[136]:
</div>

<div class="input_area" markdown="1">

```python
x = np.array([[1 , 2, 3, 4], [5, 6, 7, 8], [9, 10, 11, 12]])
x
```

</div>

<div class="output_prompt">
Out&nbsp;[136]:
</div>




{:.output_data_text}

```
array([[ 1,  2,  3,  4],
       [ 5,  6,  7,  8],
       [ 9, 10, 11, 12]])
```



<div class="in_prompt">
In&nbsp;[137]:
</div>

<div class="input_area" markdown="1">

```python
x.flatten()
```

</div>

<div class="output_prompt">
Out&nbsp;[137]:
</div>




{:.output_data_text}

```
array([ 1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12])
```



<div class="in_prompt">
In&nbsp;[138]:
</div>

<div class="input_area" markdown="1">

```python
x.reshape((1, -1))[0] # 같은 효과이나 번거로움
```

</div>

<div class="output_prompt">
Out&nbsp;[138]:
</div>




{:.output_data_text}

```
array([ 1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12])
```



# Docstring

<div class="in_prompt">
In&nbsp;[139]:
</div>

<div class="input_area" markdown="1">

```python
x.reshape?
# Shift + tab이 편함...
```

</div>

<div class="output_prompt">
Out&nbsp;[139]:
</div>


{:.output_data_text}

```
[1;31mDocstring:[0m
a.reshape(shape, order='C')

Returns an array containing the same data with a new shape.

Refer to `numpy.reshape` for full documentation.

See Also
--------
numpy.reshape : equivalent function

Notes
-----
Unlike the free function `numpy.reshape`, this method on `ndarray` allows
the elements of the shape parameter to be passed in as separate arguments.
For example, ``a.reshape(10, 11)`` is equivalent to
``a.reshape((10, 11))``.
[1;31mType:[0m      builtin_function_or_method

```


<div class="in_prompt">
In&nbsp;[140]:
</div>

<div class="input_area" markdown="1">

```python
def double(a):
    '''
    docstring 내용
    double(arr)
    '''
    return a * 2
```

</div>

<div class="in_prompt">
In&nbsp;[141]:
</div>

<div class="input_area" markdown="1">

```python
double?
```

</div>

<div class="output_prompt">
Out&nbsp;[141]:
</div>


{:.output_data_text}

```
[1;31mSignature:[0m [0mdouble[0m[1;33m([0m[0ma[0m[1;33m)[0m[1;33m[0m[1;33m[0m[0m
[1;31mDocstring:[0m
docstring 내용
double(arr)
[1;31mFile:[0m      c:\users\user\appdata\local\temp\ipykernel_15108\354467443.py
[1;31mType:[0m      function

```


<div class="in_prompt">
In&nbsp;[142]:
</div>

<div class="input_area" markdown="1">

```python
double??
# 사용자 함수는 소스도 함께 표시
```

</div>

<div class="output_prompt">
Out&nbsp;[142]:
</div>


{:.output_data_text}

```
[1;31mSignature:[0m [0mdouble[0m[1;33m([0m[0ma[0m[1;33m)[0m[1;33m[0m[1;33m[0m[0m
[1;31mSource:[0m   
[1;32mdef[0m [0mdouble[0m[1;33m([0m[0ma[0m[1;33m)[0m[1;33m:[0m[1;33m
[0m    [1;34m'''
    docstring 내용
    double(arr)
    '''[0m[1;33m
[0m    [1;32mreturn[0m [0ma[0m [1;33m*[0m [1;36m2[0m[1;33m[0m[1;33m[0m[0m
[1;31mFile:[0m      c:\users\user\appdata\local\temp\ipykernel_15108\354467443.py
[1;31mType:[0m      function

```


# 수학 공식 사용

* Array에서 작동하는 수학 공식을 쉽게 구현할 수 있다는 것이 Numpy가 과학적 Python 커뮤니티에서 널리 사용되는 이유이다.

* 다음은 평균 제곱 오차 공식(mean square error formula)이다. 회귀를 다루는 지도 머신 러닝 모델에서 사용하는 중심 공식이다.

![img]({{ '/assets/images/2022/11/14/img1.PNG' | relative_url }}){: .left-image }

* Y_prediction: 예측값
* Y: 정답값

![img]({{ '/assets/images/2022/11/14/img2.PNG' | relative_url }}){: .left-image }

# Numpy 객체 저장, 불러오기

<div class="in_prompt">
In&nbsp;[143]:
</div>

<div class="input_area" markdown="1">

```python
# np.save('filename', a) # filename.npy로 저장
```

</div>

<div class="in_prompt">
In&nbsp;[144]:
</div>

<div class="input_area" markdown="1">

```python
# b = np.load('filename.npy')
```

</div>

<div class="in_prompt">
In&nbsp;[145]:
</div>

<div class="input_area" markdown="1">

```python
# np.savetxt('new_file.csv', csv_arr) # csv로 저장
```

</div>

<div class="in_prompt">
In&nbsp;[146]:
</div>

<div class="input_area" markdown="1">

```python
# np.loadtxt('new_file.csv')
```

</div>

# Reference

* 이 포스트는 SeSAC 인공지능 SW 개발자 양성 과정 - 심선조 강사님의 강의내용을 정리한 것입니다.
* NumPy.org : [NumPy](https://numpy.org/devdocs/user/absolute_beginners.html#)
