---
layout: jupyter
title: Machine Learning (1) - ê¸°ë³¸ì‚¬ìš©
published: true
date: 2022-11-24
description: ë¨¸ì‹ ëŸ¬ë‹ ê°œìš”ì™€ ê¸°ì´ˆ
comments: true
categories:
 - machine_learning
tags:
 - python
 - numpy
 - pandas
 - machine_learning
toc: true
toc_sticky: true
toc_label: ê¸°ë³¸ ì‚¬ìš©
use_math: true
---
---
# ë¨¸ì‹ ëŸ¬ë‹(Machine Learning)

<div class="in_prompt">
In&nbsp;[1]:
</div>

<div class="input_area" markdown="1">

```python
!python -V
# !python --version
```

</div>

<div class="output_prompt">
Out&nbsp;[1]:
</div>

{:.output_stream}

```
Python 3.9.13

```

## ì¸ê³µì§€ëŠ¥, ë¨¸ì‹ ëŸ¬ë‹, ë”¥ëŸ¬ë‹

![img]({{ '/assets/images/2022/11/24/img0.PNG' | relative_url }})

ì¸ê³µì§€ëŠ¥(Artificial Intelligence): ì‚¬ê³ ë‚˜ í•™ìŠµë“± ì¸ê°„ì´ ê°€ì§„ ì§€ì ëŠ¥ë ¥ì„ ì»´í“¨í„°ë¥¼ í†µí•´ êµ¬í˜„í•˜ëŠ” ê¸°ìˆ ì´ë‹¤.  
ë¨¸ì‹ ëŸ¬ë‹(Machine Learning): ì»´í“¨í„°ê°€ ìŠ¤ìŠ¤ë¡œ í•™ìŠµí•˜ì—¬ ì¸ê³µì§€ëŠ¥ì˜ ì„±ëŠ¥ì„ í–¥ìƒì‹œí‚¤ëŠ” ê¸°ìˆ  ë°©ë²•ì´ë‹¤.  
ë”¥ëŸ¬ë‹(Deep Learning): ì¸ê°„ì´ ë‰´ë ¨ê³¼ ë¹„ìŠ·í•œ ì¸ê³µì‹ ê²½ë§ ë°©ì‹ìœ¼ë¡œ ì •ë³´ë¥¼ ì²˜ë¦¬í•œë‹¤.  

## ì§€ë„í•™ìŠµ, ë¹„ì§€ë„í•™ìŠµ, ê°•í™”í•™ìŠµ

![img]({{ '/assets/images/2022/11/24/img1.PNG' | relative_url }})

![img]({{ '/assets/images/2022/11/24/img2.PNG' | relative_url }})

ì§€ë„í•™ìŠµ(ë‹µO), ë¹„ì§€ë„í•™ìŠµ(ë‹µX), ê°•í™”í•™ìŠµ(ê²½ìŸ)

### ì§€ë„í•™ìŠµ(Supervised Learning)

![img]({{ '/assets/images/2022/11/24/img3.PNG' | relative_url }})

ê³µë¶€ì‹œê°„-ì‹œí—˜ì„±ì  í•™ìŠµê²°ê³¼ë¥¼ ë°”íƒ•ìœ¼ë¡œ ì…ë ¥ ë°ì´í„°ì— ì—†ëŠ” ê³µë¶€ì‹œê°„ì— ëŒ€í•œ ì„±ì  ì˜ˆì¸¡í•œë‹¤.

> ì§€ë„í•™ìŠµì€ ì…ë ¥ ê°’(x)ê³¼ ì •ë‹µ(t, label)ì„ í¬í•¨í•˜ëŠ” Training Dataë¥¼ ì´ìš©í•˜ì—¬ í•™ìŠµí•˜ê³ , ê·¸ í•™ìŠµëœ ê²°ê³¼ë¥¼ ë°”íƒ•ìœ¼ë¡œ ë¯¸ì§€ì˜ ë°ì´í„°(Test Data)ì— ëŒ€í•´ ë¯¸ë˜ ê°’ì„ ì˜ˆì¸¡(Predict)í•˜ëŠ” ë°©ë²•ì´ë‹¤.  
ëŒ€ë¶€ë¶„ì˜ ë¨¸ì‹ ëŸ¬ë‹ ë¬¸ì œëŠ” ì§€ë„í•™ìŠµì— í•´ë‹¹í•œë‹¤.  
ì˜ˆ1) ì‹œí—˜ ê³µë¶€ ì‹œê°„(ì…ë ¥)ê³¼ Pass/Fail(ì •ë‹µ)ì„ ì´ìš©í•˜ì—¬ ë‹¹ë½ ì—¬ë¶€ ì˜ˆì¸¡ <span style="color:red">ì´ì‚°ê°’(ë¶„ë¥˜)</span>  
ì˜ˆ2) ì§‘ í‰ìˆ˜(ì…ë ¥)ì™€ ê°€ê²© ë°ì´í„°(ì •ë‹µ)ì„ ì´ìš©í•˜ì—¬ ì„ì˜ì˜ í‰ìˆ˜ ê°€ê²© ì˜ˆì¸¡ <span style="color:red">ì—°ì†ê°’(íšŒê·€)</span>

ì§€ë„í•™ìŠµì€ í•™ìŠµê²°ê³¼ë¥¼ ë°”íƒ•ìœ¼ë¡œ ë¯¸ë˜ì˜ ë¬´ì—‡ì„ ì˜ˆì¸¡í•˜ëŠëƒì— ë”°ë¼ **íšŒê·€(Regression)**, **ë¶„ë¥˜(Classification)** ë“±ìœ¼ë¡œ êµ¬ë¶„í•  ìˆ˜ ìˆë‹¤.  

> íšŒê·€(Regression)ëŠ” Training Dataë¥¼ ì´ìš©í•˜ì—¬ ì—°ì†ì ì¸(ìˆ«ì)ê°’ì„ ì˜ˆì¸¡í•˜ëŠ” ê²ƒì´ë‹¤.  
ì˜ˆ) ì§‘ í‰ìˆ˜ì™€ ê°€ê²©ê´€ê³„, ê³µë¶€ì‹œê°„ê³¼ ì‹œí—˜ì„±ì  ë“±ì˜ ê´€ê³„

![img]({{ '/assets/images/2022/11/24/img4.PNG' | relative_url }})

>ë¶„ë¥˜(Classification)ëŠ” Training Dataë¥¼ ì´ìš©í•˜ì—¬ ì£¼ì–´ì§„ ì…ë ¥ ê°’ì´ ì–´ë–¤ ì¢…ë¥˜ì¸ì§€ êµ¬ë³„í•˜ëŠ” ê²ƒì´ë‹¤.  
ì˜ˆ) ê³µë¶€ì‹œê°„ê³¼ í•©ê²©ì—¬ë¶€

![img]({{ '/assets/images/2022/11/24/img5.PNG' | relative_url }})

### ë¹„ì§€ë„í•™ìŠµ(Unsupervised Learning)

ë¹„ì§€ë„í•™ìŠµì€ Training Dataì— ì •ë‹µì€ ì—†ê³  ì…ë ¥ ë°ì´í„°ë§Œ ìˆê¸° ë•Œë¬¸ì— ì…ë ¥ì— ëŒ€í•œ ì •ë‹µì„ ì°¾ëŠ” ê²ƒì´ ì•„ë‹Œ íŒ¨í„´, íŠ¹ì„± ë“±ì„ í•™ìŠµì„ í†µí•´ ë°œê²¬í•˜ëŠ” ë°©ë²•ì„ ë§í•œë‹¤.  
ì˜ˆ) êµ°ì§‘í™” ì•Œê³ ë¦¬ì¦˜ì„ ì´ìš©í•œ ë‰´ìŠ¤ ê·¸ë£¹í•‘, ë°±í™”ì  ìƒí’ˆ ì¶”ì²œ ì‹œìŠ¤í…œ ë“±

![img]({{ '/assets/images/2022/11/24/img6.PNG' | relative_url }})

## ì§€ë„í•™ìŠµ(Supervised Learning) - íšŒê·€(Regression)
### ì„ í˜•íšŒê·€(Linear Regression)

Training Dataë¥¼ ì´ìš©í•˜ì—¬ ë°ì´í„°ì˜ íŠ¹ì„±ê³¼ ìƒê´€ê´€ê³„ ë“±ì„ íŒŒì•…í•˜ê³ , ê·¸ ê²°ê³¼ë¥¼ ë°”íƒ•ìœ¼ë¡œ Training Dataì— ì—†ëŠ” ë¯¸ì§€ì˜ ë°ì´í„°ê°€ ì£¼ì–´ì¡Œì„ ê²½ìš°ì— ê·¸ ê²°ê³¼ë¥¼ ì—°ì†ì ì¸(ìˆ«ì)ê°’ìœ¼ë¡œ ì˜ˆì¸¡í•˜ëŠ” ê²ƒì´ë‹¤.

ì£¼ì–´ì§„ ë°ì´í„°ë¥¼ ì´ìš©í•´ ì¼ì°¨ë°©ì •ì‹ì„ ìˆ˜ì •í•´ ë‚˜ê°€ëŠ” ê²ƒì´ë‹¤.  
í•™ìŠµì„ ê±°ì³ì„œ ê°€ì¥ í•©ë¦¬ì ì¸ ì„ ì„ ì°¾ì•„ë‚´ëŠ” ê²ƒì´ë‹¤.  
í•™ìŠµì„ ë§ì´ í•´ë„ **ì™„ë²½í•œ** ì‹ì„ ì°¾ì•„ ë‚´ì§€ ëª»í•  ìˆ˜ ìˆë‹¤.  
ê°€ì¥ ê·¼ì‚¬ì¹˜ì˜ ê°’ì„ ì°¾ëŠ” ê²ƒì´ë‹¤.


* x(ë…ë¦½ë³€ìˆ˜)
* y(ì¢…ì†ë³€ìˆ˜): xì— ì˜í–¥ì„ ë°›ìŒ

<span style="color:blue">[step1]</span> analyze training data  
í•™ìŠµë°ì´í„°(training data)ëŠ” ì…ë ¥ (x)ì¸ ê³µë¶€ì‹œê°„ì— ë¹„ë¡€í•´ì„œ ì¶œë ¥(y)ì¸ ì‹œí—˜ì„±ì ë„ ì¦ê°€í•˜ëŠ” ê²½í–¥ì´ ìˆë‹¤.  
ì¦‰, ì…ë ¥(x)ê³¼ ì¶œë ¥(y) ì€ $$y = Wx + b$$ í˜•íƒœë¡œ ë‚˜íƒ€ë‚¼ ìˆ˜ ìˆë‹¤.

* W: ê°€ì¤‘ì¹˜
* b: ì ˆí¸, ë³´í†µ 0ìœ¼ë¡œ ì£¼ê³  ê³„ì‚°

![img]({{ '/assets/images/2022/11/24/img7.PNG' | relative_url }})

<span style="color:blue">[step2]</span> find W and b  
â‘ , â‘¡, â‘¢, ... ë“±ì˜ ë‹¤í–¥í•œ $$y = Wx + b$$ ì§ì„  ê°€ìš´ë° training dataì˜ íŠ¹ì„±ì„ ê°€ì¥ ì˜ í‘œí˜„í•  ìˆ˜ ìˆëŠ” ê°€ì¤‘ì¹˜ W(ê¸°ìš¸ê¸°), ë°”ì´ì–´ìŠ¤ b(yì ˆí¸)ë¥¼ ì°¾ëŠ” ê²ƒì´ í•™ìŠµ(Learning) ê°œë…ì´ë‹¤.

![img]({{ '/assets/images/2022/11/24/img8.PNG' | relative_url }})

Training dataì˜ ì •ë‹µ(t)ê³¼ ì§ì„  $$y = Wx + b$$ ê°’ì˜ ì°¨ì´ì¸ ì˜¤ì°¨(error)ëŠ”  
$$ì˜¤ì°¨(error) = t - y = t - (Wx + b)$$ ìœ¼ë¡œ ê³„ì‚°ë˜ë©°  
ì˜¤ì°¨ê°€ í¬ë‹¤ë©´ ìš°ë¦¬ê°€ ì„ì˜ë¡œ ì„¤ì •í•œ ì§ì„ ì˜ ê°€ì¤‘ì¹˜ì™€ ë°”ì´ì–´ìŠ¤ ê°’ì´ ì˜ëª»ëœ ê²ƒì´ê³  ì˜¤ì°¨ê°€ ì‘ë‹¤ë©´ ì§ì„ ì˜ ê°€ì¤‘ì¹˜ì™€ ë°”ì´ì–´ìŠ¤ ê°’ì´ ì˜ ëœ ê²ƒì´ê¸° ë•Œë¬¸ì— ë¯¸ë˜ ê°’ ì˜ˆì¸¡ë„ ì •í™•í•  ìˆ˜ ìˆë‹¤ê³  ì˜ˆìƒí•  ìˆ˜ ìˆë‹¤.

![img]({{ '/assets/images/2022/11/24/img9.PNG' | relative_url }})

ë¨¸ì‹ ëŸ¬ë‹ regression ì‹œìŠ¤í…œì€ ëª¨ë“  ë°ì´í„°ì˜ $$ì˜¤ì°¨(error) = t - y = t - (Wx + b)$$ì˜ í•©ì´ ìµœì†Œê°€ ë˜ì–´ì„œ ë¯¸ë˜ ê°’ì„ ì˜ ì˜ˆì¸¡í•  ìˆ˜ ìˆëŠ” ê°€ì¤‘ì¹˜ Wì™€ ë°”ì´ì–´ìŠ¤ bê°’ì„ ì°¾ì•„ì•¼ í•œë‹¤.


### ì†ì‹¤í•¨ìˆ˜(loss function)

ì†ì‹¤í•¨ìˆ˜ì—ì„œ ì˜¤ì°¨(error)ë¥¼ ê³„ì‚°í•  ë•ŒëŠ” $$(t - y)^2 = [t - (Wx + b)]^2$$ ì„ ì‚¬ìš©í•œë‹¤.  
ì¦‰ ì˜¤ì°¨ëŠ” ì–¸ì œë‚˜ ì–‘ìˆ˜ì´ë©°, ì œê³±ì„ í•˜ê¸° ë•Œë¬¸ì— ì •ë‹µê³¼ ê³„ì‚° ê°’ ì°¨ì´ê°€ í¬ë‹¤ë©´ ì œê³±ì— ì˜í•´ ì˜¤ì°¨ëŠ” ë” í° ê°’ì„ ê°€ì§€ê²Œ ë˜ì–´ ë¨¸ì‹  ëŸ¬ë‹ í•™ìŠµì— ìˆì–´ ì¥ì ì„ ê°€ì§„ë‹¤.

$$y = Wx + b$$

$$loss\,function = E(W, b) = \frac{1}{n}\displaystyle\sum_{i=1}^{n}{(t_i-y_i)^2} = \frac{1}{n}\displaystyle\sum_{i=1}^{n}{[t_i-(Wx_i + b)]^2}$$

Xì™€ tëŠ” training dataì—ì„œ ì£¼ì–´ì§€ëŠ” ê°’ì´ë¯€ë¡œ ì†ì‹¤í•¨ìˆ˜(loss function)ì¸ E(W,b)ëŠ” ê²°êµ­ Wì™€ bì— ì˜í–¥ì„ ë°›ëŠ” í•¨ìˆ˜ì´ë‹¤.
- E(W,b)ê°’ì´ ì‘ë‹¤ëŠ” ê²ƒì€ ì •ë‹µ(t , target)ê³¼ $$y = Wx+b$$ ì— ì˜í•´ ê³„ì‚°ëœ ê°’ì˜ í‰ê·  ì˜¤ì°¨ê°€ ì‘ë‹¤ëŠ” ì˜ë¯¸ì´ë‹¤.
- í‰ê·  ì˜¤ì°¨ê°€ ì‘ë‹¤ëŠ” ê²ƒì€ ë¯¸ì§€ì˜ ë°ì´í„° xê°€ ì£¼ì–´ì§ˆ ê²½ìš°, í™•ë¥ ì ìœ¼ë¡œ ë¯¸ë˜ì˜ ê²°ê³¼ê°’ë„ ì˜¤ì°¨ê°€ ì‘ì„ ê²ƒì´ë¼ê³  ì¶”ì¸¡í•  ìˆ˜ ìˆë‹¤.
- ì´ì²˜ëŸ¼ training dataë¥¼ ë°”íƒ•ìœ¼ë¡œ ì†ì‹¤í•¨ìˆ˜ E(W, b)ê°€ ìµœì†Œê°’ì„ ê°–ë„ë¡(W , b)ë¥¼ êµ¬í•˜ëŠ” ê²ƒì´ (linear) regression modelì˜ ìµœì¢… ëª©ì ì´ë‹¤.


### ê²½ì‚¬í•˜ê°•ë²•(gradient decent algorithm)

ê³„ì‚°ì„ ì‰½ê²Œ í•˜ê³  ì†ì‹¤í•¨ìˆ˜ì˜ ëª¨ì–‘ì„ íŒŒì•…í•˜ê¸° ìœ„í•´ E(W, b)ì—ì„œ ë°”ì´ì–´ìŠ¤ b=0ì„ ê°€ì •í–ˆë‹¤.

![img]({{ '/assets/images/2022/11/24/img10.PNG' | relative_url }})

![img]({{ '/assets/images/2022/11/24/img11.PNG' | relative_url }})

* ì†ì‹¤í•¨ìˆ˜ì˜ ê·¸ë˜í”„  
ì œê³±ì„ ì“°ë©´ 2ì°¨í•¨ìˆ˜  
ì ˆëŒ€ê°’ì„ ì“°ë©´ ë¹„ë¡€(ì§ì„ )

![img]({{ '/assets/images/2022/11/24/img12.PNG' | relative_url }})

1. ì„ì˜ì˜ ê°€ì¤‘ì¹˜ W ì„ íƒí•œë‹¤.
2. ê·¸ Wì—ì„œì˜ ì§ì„ ì˜ ê¸°ìš¸ê¸°ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ë¯¸ë¶„ ê°’(í•´ë‹¹ Wì—ì„œì˜ ë¯¸ë¶„) $$\frac{ğœ•E(W)}{ğœ•W}$$ì„ êµ¬í•œë‹¤.
3. ê·¸ ë¯¸ë¶„ ê°’ì´ ì‘ì•„ì§€ëŠ” ë°©í–¥ìœ¼ë¡œ Wê°ì†Œ(ë˜ëŠ” ì¦ê°€)ì‹œì¼œ ë‚˜ê°„ë‹¤.
4. ìµœì¢…ì ìœ¼ë¡œ ê¸°ìš¸ê¸°ê°€ ë” ì´ìƒ ì‘ì•„ì§€ì§€ ì•ŠëŠ” ê³³ì„ ì°¾ì„ ìˆ˜ ìˆëŠ”ë°, ê·¸ ê³³ì´ ì†ì‹¤í•¨ìˆ˜ E(W) ìµœì†Œê°’ì„ì„ ì•Œ ìˆ˜ ìˆë‹¤.

ì´ì²˜ëŸ¼ Wì—ì„œì˜ ì§ì„ ì˜ ê¸°ìš¸ê¸°ì¸ ë¯¸ë¶„ ê°’ì„ ì´ìš©í•˜ì—¬ ê·¸ ê°’ì´ ì‘ì•„ì§€ëŠ” ë°©í–¥ìœ¼ë¡œ ì§„í–‰í•˜ì—¬ ì†ì‹¤í•¨ìˆ˜ ìµœì†Œê°’ì„ ì°¾ëŠ” ë°©ë²•ì„ ê²½ì‚¬í•˜ê°•ë²•(gradient decent algorithm)ì´ë¼ê³  í•œë‹¤.


* Wì—ì„œì˜ í¸ë¯¸ë¶„ $$\frac{ğœ•E(W)}{ğœ•W}$$ ëŠ” í•´ë‹¹ Wì—ì„œ ê¸°ìš¸ê¸°(slope)ë¥¼ ë‚˜íƒ€ë‚¸ë‹¤.  
->$$\frac{ğœ•E(W)}{ğœ•W}$$ ì´ ì–‘ìˆ˜(+) ê°’ì„ ê°–ëŠ”ë‹¤ë©´ WëŠ” ì™¼ìª½ìœ¼ë¡œ ì´ë™ì‹œì¼œì•¼ë§Œ(ê°ì†Œ) ì†ì‹¤í•¨ìˆ˜ E(W) ìµœì†Œê°’ì„ ì°¾ì„ ìˆ˜ ìˆë‹¤.  
->$$\frac{ğœ•E(W)}{ğœ•W}$$ ì´ ì–‘ìˆ˜(-) ê°’ì„ ê°–ëŠ”ë‹¤ë©´ WëŠ” ì˜¤ë¥¸ìª½ìœ¼ë¡œ ì´ë™ì‹œì¼œì•¼ë§Œ(ì¦ê°€) ì†ì‹¤í•¨ìˆ˜ E(W) ìµœì†Œê°’ì„ ì°¾ì„ ìˆ˜ ìˆë‹¤.

$$w = w - a\frac{ğœ•E(W, b)}{ğœ•W}$$

* ğ‘ëŠ” í•™ìŠµë¥ (learning rate)ì´ë¼ê³  ë¶€ë¥´ë©°, W ê°’ì˜ ê°ì†Œ ë˜ëŠ” ì¦ê°€ ë˜ëŠ” ë¹„ìœ¨ì„ ë‚˜íƒ€ë‚¸ë‹¤.(Wë¥¼ ì–¼ë§ˆë‚˜ ì´ë™ì‹œí‚¬ì§€)


## ì§€ë„í•™ìŠµ - ë¶„ë¥˜(Classification)
### ì˜ì‚¬ê²°ì • íŠ¸ë¦¬(Decision Tree)

![img]({{ '/assets/images/2022/11/24/img13.PNG' | relative_url }})

K-nearest neighbor classifier(K-ìµœê·¼ì ‘ ì´ì›ƒ ë¶„ë¥˜ê¸°)

![img]({{ '/assets/images/2022/11/24/img14.PNG' | relative_url }})

Kë¥¼ í™€ìˆ˜ë¡œ í•˜ì—¬ ì–´ëŠìª½ì—ë“  ì†Œì†ë˜ê²Œ í•œë‹¤

![img]({{ '/assets/images/2022/11/24/img15.PNG' | relative_url }})

## ë¹„ì§€ë„í•™ìŠµ - êµ°ì§‘

K-means Clustering(í‰ê·  êµ°ì§‘)

KMeans í´ëŸ¬ìŠ¤í„°ë§ ì•Œê³ ë¦¬ì¦˜ì€ nê°œì˜ ì¤‘ì‹¬ì ì„ ì°ì€ í›„ì—, ì´ ì¤‘ì‹¬ì ì—ì„œ ê° ì ê°„ì˜ ê±°ë¦¬ì˜ í•©ì´ ê°€ì¥ ìµœì†Œí™”ê°€ ë˜ëŠ” ì¤‘ì‹¬ì  nì˜ ìœ„ì¹˜ë¥¼ ì°¾ê³ , ì´ ì¤‘ì‹¬ì ì—ì„œ ê°€ê¹Œìš´ ì ë“¤ì„ ì¤‘ì‹¬ì ì„ ê¸°ì¤€ìœ¼ë¡œ ë¬¶ëŠ” í´ëŸ¬ìŠ¤í„°ë§ ì•Œê³ ë¦¬ì¦˜ì´ë‹¤.

![img]({{ '/assets/images/2022/11/24/img16.PNG' | relative_url }})

# ì‚¬ì´í‚·ëŸ°ìœ¼ë¡œ ì‹œì‘í•˜ëŠ” ë¨¸ì‹ ëŸ¬ë‹

ì‚¬ì´í‚·ëŸ°(sciket-learn)ì€ íŒŒì´ì¬ ë¨¸ì‹ ëŸ¬ë‹ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì¤‘ ê°€ì¥ ë§ì´ ì‚¬ìš©ë˜ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ì´ë‹¤.  
OOPì˜ íŠ¹ì§•ì„ ì‚¬ìš©(ìƒì†ì˜ ê°œë…)í•œë‹¤.

<div class="in_prompt">
In&nbsp;[2]:
</div>

<div class="input_area" markdown="1">

```python
import sklearn
```

</div>

<div class="in_prompt">
In&nbsp;[3]:
</div>

<div class="input_area" markdown="1">

```python
sklearn.__version__ # í´ë˜ìŠ¤ì˜ ì†ì„±ê°’ì„ ë³´í†µ __ê°’__ìœ¼ë¡œ ì €ì¥í•´ ë†“ëŠ”ë‹¤
```

</div>

<div class="output_prompt">
Out&nbsp;[3]:
</div>




{:.output_data_text}

```
'1.0.2'
```



## ë¶“ê½ƒ(Iris) í’ˆì¢… ì˜ˆì¸¡

<div class="in_prompt">
In&nbsp;[4]:
</div>

<div class="input_area" markdown="1">

```python
from sklearn.datasets import load_iris
# loadê°€ ì•„ë‹Œ fetchë¡œ ëœê²ƒì€ ì¸í„°ë„·ìœ¼ë¡œ ë°›ëŠ” ë°ì´í„° ì„¸íŠ¸
from sklearn.tree import DecisionTreeClassifier
# ì˜ì‚¬ ê²°ì • íŠ¸ë¦¬
from sklearn.model_selection import train_test_split
# ë°ì´í„° ë¶„ë¦¬(í•™ìŠµ/ê²€ì¦) - ë°ì´í„° 100% ì¤‘ í•™ìŠµìš©ê³¼ ê²€ì¦ìš© ë°ì´í„°ë¥¼ ë¶„ë¦¬í•˜ì—¬ ë¨¸ì‹ ëŸ¬ë‹ í›„ í•™ìŠµ ì´ì™¸ì˜ ë°ì´í„°ë¡œ í…ŒìŠ¤íŠ¸í•˜ê¸° ìœ„í•´
import pandas as pd
# ë°ì´í„° ì „ì²˜ë¦¬
```

</div>

* iris data feature(X)
    * sepal length(ê½ƒë°›ì¹¨ ê¸¸ì´)
    * sepal width(ê½ƒë°›ì¹¨ ë„ˆë¹„)
    * petal length(ê½ƒì ê¸¸ì´)
    * petal width(ê½ƒì ë„ˆë¹„)

* iris data label(y)
    * Setosa
    * Vesicolor
    * Virginica

<div class="in_prompt">
In&nbsp;[5]:
</div>

<div class="input_area" markdown="1">

```python
iris = load_iris(as_frame=True) # as_frame: dictionary_like í˜•íƒœì˜ ë°ì´í„°ë¥¼ dataframeí˜•íƒœë¡œ
```

</div>

<div class="in_prompt">
In&nbsp;[6]:
</div>

<div class="input_area" markdown="1">

```python
type(iris)
```

</div>

<div class="output_prompt">
Out&nbsp;[6]:
</div>




{:.output_data_text}

```
sklearn.utils.Bunch
```



<div class="in_prompt">
In&nbsp;[7]:
</div>

<div class="input_area" markdown="1">

```python
iris.data.head(3)
```

</div>

<div class="output_prompt">
Out&nbsp;[7]:
</div>




<div markdown="0">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sepal length (cm)</th>
      <th>sepal width (cm)</th>
      <th>petal length (cm)</th>
      <th>petal width (cm)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>5.1</td>
      <td>3.5</td>
      <td>1.4</td>
      <td>0.2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4.9</td>
      <td>3.0</td>
      <td>1.4</td>
      <td>0.2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4.7</td>
      <td>3.2</td>
      <td>1.3</td>
      <td>0.2</td>
    </tr>
  </tbody>
</table>
</div>
</div>



<div class="in_prompt">
In&nbsp;[8]:
</div>

<div class="input_area" markdown="1">

```python
iris_df = iris.data.copy()

iris_df['label'] = iris.target # targetëª…ì„ í•˜ë‚˜ì˜ columnìœ¼ë¡œ ì¶”ê°€

iris_df.head(3)
```

</div>

<div class="output_prompt">
Out&nbsp;[8]:
</div>




<div markdown="0">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sepal length (cm)</th>
      <th>sepal width (cm)</th>
      <th>petal length (cm)</th>
      <th>petal width (cm)</th>
      <th>label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>5.1</td>
      <td>3.5</td>
      <td>1.4</td>
      <td>0.2</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4.9</td>
      <td>3.0</td>
      <td>1.4</td>
      <td>0.2</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4.7</td>
      <td>3.2</td>
      <td>1.3</td>
      <td>0.2</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>
</div>



<div class="in_prompt">
In&nbsp;[9]:
</div>

<div class="input_area" markdown="1">

```python
iris.data.head(3)
```

</div>

<div class="output_prompt">
Out&nbsp;[9]:
</div>




<div markdown="0">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sepal length (cm)</th>
      <th>sepal width (cm)</th>
      <th>petal length (cm)</th>
      <th>petal width (cm)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>5.1</td>
      <td>3.5</td>
      <td>1.4</td>
      <td>0.2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4.9</td>
      <td>3.0</td>
      <td>1.4</td>
      <td>0.2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4.7</td>
      <td>3.2</td>
      <td>1.3</td>
      <td>0.2</td>
    </tr>
  </tbody>
</table>
</div>
</div>



<div class="in_prompt">
In&nbsp;[10]:
</div>

<div class="input_area" markdown="1">

```python
iris.target_names
```

</div>

<div class="output_prompt">
Out&nbsp;[10]:
</div>




{:.output_data_text}

```
array(['setosa', 'versicolor', 'virginica'], dtype='<U10')
```



<div class="in_prompt">
In&nbsp;[11]:
</div>

<div class="input_area" markdown="1">

```python
X_train, X_test, y_train, y_test = train_test_split(iris.data, iris.target, test_size=0.2, random_state=11)
# test_sizeì™€ train_size í•©ì³ì„œ 1ì´ ë˜ê²Œ ì„¤ì •, random_state: randomì˜ seedì™€ ê°™ì€ ê°œë…
# iris.dataì™€ iris.targetê°€ ê°™ì€ ìœ„ì¹˜ì˜ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ë„ë¡ ë‘˜ë‹¤ íŒŒë¼ë¯¸í„°ë¡œ ë„£ì–´ì¤€ë‹¤
# iris.data ê°€ X-train(8):X_test(2)ë¡œ, iris.targetì´ y_train(8):y_test(2)ë¡œ ë‚˜ë‰˜ì–´ì ¸ ë“¤ì–´ê°„ë‹¤
# ë³´í†µ X(ëŒ€ë¬¸ì)-ë¬¸ì œ(input) y(ì†Œë¬¸ì)-ë‹µ(target)
```

</div>

<div class="in_prompt">
In&nbsp;[12]:
</div>

<div class="input_area" markdown="1">

```python
# ì˜ì‚¬ê²°ì •íŠ¸ë¦¬ ê°ì²´ ìƒì„±
dt_clf = DecisionTreeClassifier(random_state=11)
```

</div>

<div class="in_prompt">
In&nbsp;[13]:
</div>

<div class="input_area" markdown="1">

```python
# ëª¨ë¸ í•™ìŠµ ìˆ˜í–‰
dt_clf.fit(X_train, y_train)
```

</div>

<div class="output_prompt">
Out&nbsp;[13]:
</div>




{:.output_data_text}

```
DecisionTreeClassifier(random_state=11)
```



<div class="in_prompt">
In&nbsp;[14]:
</div>

<div class="input_area" markdown="1">

```python
# ì˜ˆì¸¡ ìˆ˜í–‰
pred = dt_clf.predict(X_test)
```

</div>

<div class="in_prompt">
In&nbsp;[15]:
</div>

<div class="input_area" markdown="1">

```python
from sklearn.metrics import accuracy_score
# metricsí‰ê°€ì™€ ê´€ë ¨ëœ ê²ƒì„ ëª¨ì•„ë‘”
```

</div>

<div class="in_prompt">
In&nbsp;[16]:
</div>

<div class="input_area" markdown="1">

```python
# ì˜ˆì¸¡ ì •í™•ë„ ì¸¡ì •
accuracy_score(y_test, pred)
```

</div>

<div class="output_prompt">
Out&nbsp;[16]:
</div>




{:.output_data_text}

```
0.9333333333333333
```



ë¨¸ì‹ ëŸ¬ë‹ì˜ íë¦„
* ë°ì´í„° í¬ë¡¤ë§<<ì´ë¯¸ ì™„ë£Œëœ ë°ì´í„°  
* ë°ì´í„° ì „ì²˜ë¦¬(ëª¨ë¸ë§)<<ì´ë¯¸ ì™„ë£Œëœ ë°ì´í„°  
* ë°ì´í„° ì„¸íŠ¸ ë¶„ë¦¬
* í•™ìŠµ  
* ì˜ˆì¸¡  
* í‰ê°€  

ìì—°ì–´ ì²˜ë¦¬ì‹œ ë¬´ì¡°ê±´ ìˆ«ìë¡œ ë°”ê¿”ì•¼ í•¨ (ê¸€ìëŠ” ì•ˆëœë‹¤)

<div class="in_prompt">
In&nbsp;[17]:
</div>

<div class="input_area" markdown="1">

```python
dt_clf.predict([[4.67, 3.9, 2, 0.4]]) # í•™ìŠµì— ë„£ì€ ë°ì´í„° ëª¨ì–‘ëŒ€ë¡œ ë„£ì–´ì•¼ í•œë‹¤ # setosaë¼ ì˜ˆì¸¡
```

</div>

<div class="output_prompt">
Out&nbsp;[17]:
</div>

{:.output_stream}

```
C:\Users\user\anaconda3\lib\site-packages\sklearn\base.py:450: UserWarning: X does not have valid feature names, but DecisionTreeClassifier was fitted with feature names
  warnings.warn(

```




{:.output_data_text}

```
array([0])
```



<div class="in_prompt">
In&nbsp;[18]:
</div>

<div class="input_area" markdown="1">

```python
# ì˜ˆì¸¡ëª¨ë¸ ì €ì¥
import pickle
```

</div>

<div class="in_prompt">
In&nbsp;[19]:
</div>

<div class="input_area" markdown="1">

```python
f = open('model', 'wb')
pickle.dump(dt_clf, f)
f.close()
```

</div>

<div class="in_prompt">
In&nbsp;[20]:
</div>

<div class="input_area" markdown="1">

```python
# ì˜ˆì¸¡ëª¨ë¸ ë¶ˆëŸ¬ì˜¤ê¸°
f = open('model', 'rb')
model = pickle.load(f)
f.close()
```

</div>

<div class="in_prompt">
In&nbsp;[21]:
</div>

<div class="input_area" markdown="1">

```python
model.predict([[4.67, 3.9, 2, 0.4]])
```

</div>

<div class="output_prompt">
Out&nbsp;[21]:
</div>

{:.output_stream}

```
C:\Users\user\anaconda3\lib\site-packages\sklearn\base.py:450: UserWarning: X does not have valid feature names, but DecisionTreeClassifier was fitted with feature names
  warnings.warn(

```




{:.output_data_text}

```
array([0])
```



## ê¸°ë³¸ìœ¼ë¡œ ë¶ˆëŸ¬ì˜¤ê¸°

<div class="in_prompt">
In&nbsp;[22]:
</div>

<div class="input_area" markdown="1">

```python
iris = load_iris()
```

</div>

<div class="in_prompt">
In&nbsp;[23]:
</div>

<div class="input_area" markdown="1">

```python
type(iris) # dictionary_like
```

</div>

<div class="output_prompt">
Out&nbsp;[23]:
</div>




{:.output_data_text}

```
sklearn.utils.Bunch
```



<div class="in_prompt">
In&nbsp;[24]:
</div>

<div class="input_area" markdown="1">

```python
iris.keys()
```

</div>

<div class="output_prompt">
Out&nbsp;[24]:
</div>




{:.output_data_text}

```
dict_keys(['data', 'target', 'frame', 'target_names', 'DESCR', 'feature_names', 'filename', 'data_module'])
```



<div class="in_prompt">
In&nbsp;[25]:
</div>

<div class="input_area" markdown="1">

```python
# iris.items()
```

</div>

<div class="in_prompt">
In&nbsp;[26]:
</div>

<div class="input_area" markdown="1">

```python
# iris.values()
```

</div>

## Model Selection ëª¨ë“ˆ ì†Œê°œ

* train_test_split() : í•™ìŠµ/í…ŒìŠ¤íŠ¸ ë°ì´í„° ì„¸íŠ¸ ë¶„ë¦¬

<div class="in_prompt">
In&nbsp;[27]:
</div>

<div class="input_area" markdown="1">

```python
iris = load_iris()
dt_clf = DecisionTreeClassifier()
# í•™ìŠµ
dt_clf.fit(iris.data, iris.target)
#ì˜ˆì¸¡
pred = dt_clf.predict(iris.data)
#í‰ê°€
accuracy_score(iris.target, pred)
```

</div>

<div class="output_prompt">
Out&nbsp;[27]:
</div>




{:.output_data_text}

```
1.0
```



ë¶„ë¦¬í•˜ì§€ ì•Šìœ¼ë©´ í‰ê°€ë¥¼ í•´ë„ 100%ê°€ ë˜ì–´ë²„ë¦¼

# Reference

* ì´ í¬ìŠ¤íŠ¸ëŠ” SeSAC ì¸ê³µì§€ëŠ¥ ìì—°ì–´ì²˜ë¦¬, ì»´í“¨í„°ë¹„ì „ ê¸°ìˆ ì„ í™œìš©í•œ ì‘ìš© SW ê°œë°œì ì–‘ì„± ê³¼ì • - ì‹¬ì„ ì¡° ê°•ì‚¬ë‹˜ì˜ ê°•ì˜ë¥¼ ì •ë¦¬í•œ ë‚´ìš©ì…ë‹ˆë‹¤.
