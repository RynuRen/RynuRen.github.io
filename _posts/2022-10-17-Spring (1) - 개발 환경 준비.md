---
layout: post
title: Spring (1) - 개발 환경 준비
date:   2022-10-17
description: Spring (1) - 개발 환경 준비
toc: true
tags:
 - spring boot
---

1. **_개발 환경 준비_**
2. Spring IoC
3. Spring MVC
4. Database 활용
5. View Template
6. AOP / Filter / Interceptor
7. File Upload / Download

# IDE 설치 및 설정
* VSCode(Visual Studio Code) 사용


## VSCode Extensions

![img]({{ '/assets/images/2022-10-17/img1.png' | relative_url }}){: .center-image }*Extensions*

* Spring Boot Dashboard
* Spring Boot Extension Pack
* Spring Boot Tools
* Spring Initializr Java Support
* Lombok Annotations Supprot for VS Code
* Extension Pack for Java
* Test Runner for Java
* Maven for Java
* Project Manager for Java
* Language Support for Java


## Spring 소개
* 자바 플랫폼을 위한 **오픈 소스 어플리케이션 프레임워크**
* **동적인 웹 사이트 개발**하기 위한 여러가지 서비스 제공
* 대한민국 공공기관의 웹 서비스 개발 시 사용을 권장하고 있는 **전자정부 표준 프레임워크**의 기반 기술


### 특징
* 경량 컨테이너
* 특정 인터페이스/클래스를 상속 받을 필요 없음(**POJO**)
* **IoC/DI, AOP** 지원
* 확장성이 높음(**유지보수↑**)


### Spring Container (WAS)

![img]({{ '/assets/images/2022-10-17/img2.png' | relative_url }}){: .center-image }*Spring Container*

* DI(Dependency Injection) 의존성 주입
* IoC(Inversion of Control) 제어의 역전
프레임워크가 원하는 규격에 맞춰 개발해야함
* Bean Factory
Bean을 이용해 객체 등록
Spring에서 객체는 포괄적: 메소드, 변수, 클래스 등을 포괄적으로 Bean으로 표현함


# Spring Boot 프로젝트 생성
`Ctrl`{:.key}+`Shift`{:.key}+`P`{:.key} => `Spring Initializr: Create Maven` =>

`v2.6.12` => `Java` => `com.example` => `demo` => `Jar` => `v11`

## 의존성 주입(8개)
* Spring Web
* Thymeleaf
* Spring Data JPA
* MariaDB Driver
* H2 Database
* MySqL Driver
* Spring Boot DevTools
* Lombok


# Spring Boot 프로젝트 실행
## Controller 설정
* \src\main\java\com\example\demo\controller\

>Java
{:.filename}
{% highlight java linenos%}
package com.example.demo.controller;

import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.RequestMapping;

// @Controller: 다음 오는 클래스를 컨트롤러 객체(bean)로 생성해서 등록
@Controller
public class HomeController {
    // @RequestMapping: 요청 url에 따라 해당 메소드를 실행
    @RequestMapping("/") // '/'는 최상위 폴더(주소)
                        // 즉 최상위 url을 요청하면 아래 메소드 실행
    public String home(){
        return "home"; // Spring에서는 문자열을 넘겨주면 문자열.html을 찾아 보여줌
    }
}
{% endhighlight %}


## frontpage html 작성
* \src\main\resources\templates\home.html

>HTML
{:.filename}
{% highlight html linenos%}
<html xmlns:th="http://www.thymeleaf.org">
<!--html주석-->
<!--html 태그가 있아야 함
xmlns:th 템플릿 사용 옵션-->

<head> <!-- 해당 페이지의 메타정보가 포함됨
    jave의 import처럼 참조할 css위치 등을 표시 -->
</head>

<body> <!-- 실제 화면에 출력될 요소를 포함-->
    <h1>Home : 홈페이지 입니다.</h1>
    <!--h1: head 문자열을 표현할 때 사용하는 태그
        숫자는 글자 크기-->
    <h2>h2</h2>
    <h3>h3</h3>
    <h4>h4</h4>
    <h5>h5</h5>
    <h6>h6</h6>
    <p>p: 기본 문자열을 나타내는 태그</p>
</body>

<footer> <!-- body 태그 안에 들어가는 경우도 있음. head, body 만 있어도 됨-->
    <h1>footer 입니다.</h1>
</footer>

</html>
{% endhighlight %}

## pom.xml 수정
* Spring Data JPA 주석 처리
* \pom.xml

>XML
{:.filename}
{% highlight xml linenos %}
{% raw %}

...

<dependencies>
		<!-- <dependency>
			<groupId>org.springframework.boot</groupId>
			<artifactId>spring-boot-starter-data-jpa</artifactId>
		</dependency> -->
		<dependency>
			<groupId>org.springframework.boot</groupId>
			<artifactId>spring-boot-starter-thymeleaf</artifactId>
		</dependency>

...

{% endraw %}
{% endhighlight xml %}

## 자주 사용하는 VSCode 단축키
* 주석: `Ctrl`{:.key} + `/`{:.key}

* 소스코드 정리: `Alt`{:.key} + `Shift`{:.key} + `F`{:.key}

* 한줄 삭제: `Ctrl`{:.key} + `Shift`{:.key} + `K`{:.key}

* 한줄 복사: `Alt`{:.key} + `Shift`{:.key} + `↑`{:.key}`↓`{:.key}

* 한줄씩 라인 이동: `Alt`{:.key} + `↑`{:.key}`↓`{:.key}


## Slf4j - Log 사용
* `Lombok`: Spring에서 사용하는 여러가지 번거로운 작업을 어노테이션화 해서 제공
대표적으로 로그출력을 위한 `@Slf4j`, `@Getter`, `@Setter` 등이 있다.


### Lombok의 Slf4j
* `Slf4j`: log를 남길 때 세부적으로 나눠 출력 가능
* \src\main\java\com\example\demo\controller\

>Java
{:.filename}
{% highlight java linenos%}
package com.example.demo.controller;

import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.RequestMapping;

import lombok.extern.slf4j.Slf4j;

@Controller
@Slf4j
public class HomeController {
    @RequestMapping("/")
    public String home(){
        log.trace("trace!");
        log.debug("debug!");
        log.info("info!");
        log.warn("warn!");
        log.error("error!");
        return "home";
    }
}
{% endhighlight %}


* \application.properties

>Spring Boot Properties
{:.filename}
{% highlight bash %}
# log level
logging.level.com.example.demo=trace
{% endhighlight bash %}

#### log 종류
* trace : debug보다 좀 더 상세한 정보를 나타냄
* debug : 프로그램을 디버깅하기 위한 정보 지정
* info : 상태변경과 같은 정보성 메시지를 나타냄
* warn : 처리 가능한 문제, 향후 시스템 에러의 원인이 될 수 있는 경고성 메시지를 나타냄
* error : 요청을 처리하는 중 문제가 발생한 경우

>Java
{:.filename}
{% highlight java %}
if(결과값 유무 체크){
    // 정상 처리
}else{
    // 에러 발생 경우
}
{% endhighlight %}

>Java
{:.filename}
{% highlight java %}
try{
    // 시도할 소스코드
}catch (Exception e){
    // try문을 수행중 에러(예외) 발생할 경우 실행코드
}
{% endhighlight %}
        
>일반적으로 많은 개발자들이 System.out.println()을 사용하고 있음
관공서 프로젝트에서 보안상 문제로 log를 출력, 남기면 안되는 경우도 있어서..
{: .note}


### Spring에서 제공하는 어노테이션
(Spring을 사용하기 위해 필수인 어노테이션)
* @Controller : 요청과 응답을 처리하는 클래스
요청에 대해 구체적인 처리는 Service에서 처리
* @Service : 비지니스 로직을 구현하기 위해 사용하는 클래스

>Java
{:.filename}
{% highlight Java linenos %}
@RequestMapping("/longin")
public String lonin(String id, String pw){
    id = datebaseIdValue // 로 작성하면 안됨. 정석은 Service 클래스에서 작성

    // 응답과 요청에 대한 결과만 나타내주는게 정석
    if(/*서비스에서 비지니스 로직이 끝난 결과값*/){
        // 로그인 성공 했을 경우 보여줄 페이지
    }else{
        // 로그인 실패 했을 경우 보여줄 페이지
    }
    return "login";
}
{% endhighlight %}

* @Repository : 서비스에서 요청을 받아 DB를 연결 + 결과 값을 서비스에 반환하는 클래스

* @Component : 위 3가지의 어노테이션의 상위(부모) 객체
    클래스, 메소드, 변수 등을 포함하는 bean 자체로 등록 


### MVC (Model View Controller) 패턴
(디자인 패턴의 일종)

    User - html(프론트엔드 혹은 화면) - 컨트롤러 - 서비스 - 레파지토리 - DB

모델이라는 클래스에 추가해 html로 보내주면 모델 객체안의 정보를 화면에 출력
DB나 레파지토리에서 정보를 담을 그릇을 VO(Value Object), DTO(Data Transfer Object) 클래스 (DB의 테이블과 똑같이 만들어짐)

#### 모델(Model)
* 데이터를 가진 객체
* 데이터는 내부에 상태 정보를 가질 수도 있고, 모델을 표현하는 이름을 속성으로 가질 수 있다

1. 사용자가 편집하길 원하는 모든 데이터를 가지고 있어야만 함
2. 뷰(View)나 컨트롤러(Controller)에 대해서 어떤 정보도 알지 말이야 함
3. 변경이 일어나면, 변경 통지에 대한 처리 방법을 구현해야만 함

#### 뷰(View)
* 사용자 인터페이스(UI)의 요소
* 데이터 및 객체의 입력, 보여주는 출력을 담당

1. 모델이 가지고 있는 정보를 따로 저장해서는 안됨
2. 모델이나 컨트롤러과 같이 다른 구성 요소를 몰라야 됨
3. 변경이 일어나면, 변경 통지에 대한 처리 방법을 구현해야만 함

#### 컨트롤러(Controller)
* 데이터와 UI요소들을 잇는 다리 역할
* User가 데이터를 클릭하고 수정하는 것에 대한 이벤트들을 처리하는 부분

1. 모델이나 뷰에 대해서 알고 있어야 함
2. 모델이나 뷰의 변경을 모니터링 해야 함

출처: [https://bsnippet.tistory.com/m/13](https://bsnippet.tistory.com/m/13)


## Database 설정
DB는 일단 패스
